import{I as B}from"./chunk-GEGIBWTP-CDNfagPf.js";import{ei as C,j as e,R as H,d as J,a as $,S as F,q as V,b as c,H as g,A as I,B as D,L as q,aB as G,aj as W,dj as Y,s as K,em as Z,b2 as U,be as X,r as T,en as ee,V as te,ef as se,t as P}from"./index-Br7KcgVZ.js";import{T as m,a as h}from"./chunk-MSDRGCRR-B49IUHK3.js";import{P as l}from"./chunk-P3UUX2T6-CLQSpNsH.js";import{u as z,_ as E}from"./chunk-GIYLQ7GZ-DxufMlpi.js";import"./lodash-Cir5W1CW.js";import"./chunk-RGGFF4GO-BmdmKppo.js";import"./chunk-BNLHRJ2A-B6UFSb8F.js";import"./chunk-KHOKHZC6-CP-tyRv6.js";import{g as ie}from"./chunk-OIAPXGI2-CwJkVoCw.js";import{S as d}from"./chunk-LFLGEXIG-CRH6mmi7.js";import{T as N}from"./chunk-2RQLKDBF-ByAB-Zu3.js";import{u as R}from"./chunk-C76H5USB-snx4tQYu.js";import{u as re}from"./chunk-EPATMX2O-Fnr0vyLv.js";import{P as k}from"./pencil-square-DvX6HK1G.js";import{T as A}from"./trash-CF90J7Pj.js";import{u as O}from"./use-prompt-BJQZ-chh.js";import{C as b}from"./container-DT4nbkLO.js";import{c as M}from"./index-CTi5Aiew.js";import"./chunk-YEDAFXMB-DMaLwnzJ.js";import"./chunk-AOFGTNG6-BfTCSYr4.js";import"./table-Oe8J9KZe.js";import"./chunk-WX2SMNCD-B8Y84W59.js";import"./plus-mini-Bys5jE3c.js";import"./command-bar-D4WdMclT.js";import"./index-DTt8xJH5.js";import"./_isIndex-69RBt1x5.js";import"./x-mark-mini-7wDt4qdT.js";import"./date-picker-DwI7Qf6K.js";import"./clsx-B-dksMZM.js";import"./popover-ntoiPHLH.js";import"./triangle-left-mini-BCF8TRqK.js";import"./Trans-D_-MLUQW.js";import"./check-C_q2Aw8o.js";import"./format-Bc3Z-myT.js";import"./prompt-BFK30w09.js";var L="*variants,*variants.product,*variants.options",tt=i=>{const{id:t}=i.params||{},{inventory_item:s}=C(t,{fields:L},{initialData:i.data,enabled:!!t});return s?e.jsx("span",{children:s.title??s.sku??t}):null},ae=({inventoryItem:i})=>{const{t}=c();return e.jsxs(b,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(g,{level:"h2",children:t("products.attributes")}),e.jsx(I,{groups:[{actions:[{label:t("actions.edit"),to:"attributes",icon:e.jsx(k,{})}]}]})]}),e.jsx(d,{title:t("fields.height"),value:i.height}),e.jsx(d,{title:t("fields.width"),value:i.width}),e.jsx(d,{title:t("fields.length"),value:i.length}),e.jsx(d,{title:t("fields.weight"),value:i.weight}),e.jsx(d,{title:t("fields.midCode"),value:i.mid_code}),e.jsx(d,{title:t("fields.hsCode"),value:i.hs_code}),e.jsx(d,{title:t("fields.countryOfOrigin"),value:ie(i.origin_country)})]})},ne=({level:i})=>{const{t}=c(),s=O(),{mutateAsync:r}=ee(i.inventory_item_id,i.location_id),a=async()=>{await s({title:t("general.areYouSure"),description:t("inventory.deleteWarning"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await r()};return e.jsx(I,{groups:[{actions:[{icon:e.jsx(k,{}),label:t("actions.edit"),to:`locations/${i.location_id}`}]},{actions:[{icon:e.jsx(A,{}),label:t("actions.delete"),onClick:a,disabled:i.reserved_quantity>0||i.stocked_quantity>0}]}]})},j=M(),oe=()=>{const{t:i}=c();return T.useMemo(()=>[j.accessor("stock_locations.0.name",{header:i("fields.location"),cell:({getValue:t})=>{const s=t();return s?e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s.toString()})}):e.jsx(l,{})}}),j.accessor("reserved_quantity",{header:i("inventory.reserved"),cell:({getValue:t})=>{const s=t();return Number.isNaN(s)?e.jsx(l,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s})})}}),j.accessor("stocked_quantity",{header:i("fields.inStock"),cell:({getValue:t})=>{const s=t();return Number.isNaN(s)?e.jsx(l,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s})})}}),j.accessor("available_quantity",{header:i("inventory.available"),cell:({getValue:t})=>{const s=t();return Number.isNaN(s)?e.jsx(l,{}):e.jsx("div",{className:"flex size-full items-center overflow-hidden",children:e.jsx("span",{className:"truncate",children:s})})}}),j.display({id:"actions",cell:({row:t})=>e.jsx(ne,{level:t.original})})],[i])},le=({pageSize:i=20,prefix:t})=>{const s=R(["id","location_id","stocked_quantity","reserved_quantity","incoming_quantity","available_quantity","*stock_locations"],t),{reserved_quantity:r,stocked_quantity:a,available_quantity:n,...o}=s;return{searchParams:{limit:i,reserved_quantity:r?JSON.parse(r):void 0,stocked_quantity:a?JSON.parse(a):void 0,available_quantity:n?JSON.parse(n):void 0,...o},raw:s}},w=20,ce=({inventory_item_id:i})=>{const{searchParams:t,raw:s}=le({pageSize:w}),{inventory_levels:r,count:a,isPending:n,isError:o,error:f}=Z(i,{...t,fields:"*stock_locations"}),x=oe(),{table:_}=z({data:r??[],columns:x,count:a,enablePagination:!0,getRowId:y=>y.id,pageSize:w});if(o)throw f;return e.jsx(E,{table:_,columns:x,pageSize:w,count:a,isLoading:n,pagination:!0,queryObject:s})},de=({inventoryItem:i})=>{const{t}=c();return e.jsxs(b,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(g,{children:t("inventory.locationLevels")}),e.jsx(D,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(q,{to:"locations",children:t("inventory.manageLocations")})})]}),e.jsx(ce,{inventory_item_id:i.id})]})},ue=({date:i})=>{const{getFullDate:t}=re();return i?e.jsx("div",{className:"flex h-full w-full items-center overflow-hidden",children:e.jsx(te,{className:"z-10",content:e.jsx("span",{className:"text-pretty",children:`${t({date:i,includeTime:!0})}`}),children:e.jsx("span",{className:"truncate",children:t({date:i,includeTime:!0})})})}):e.jsx(l,{})},me=({reservation:i})=>{const{t}=c(),s=O(),{mutateAsync:r}=se(i.id),a=async()=>{await s({title:t("general.areYouSure"),description:t("inventory.deleteWarning"),confirmText:t("actions.delete"),cancelText:t("actions.cancel")})&&await r(void 0,{onSuccess:()=>{P.success(t("inventory.reservation.deleteSuccessToast"))},onError:o=>{P.error(o.message)}})};return e.jsx(I,{groups:[{actions:[{icon:e.jsx(k,{}),label:t("actions.edit"),to:`/reservations/${i.id}/edit`}]},{actions:[{icon:e.jsx(A,{}),label:t("actions.delete"),onClick:a}]}]})},u=M(),xe=({sku:i})=>{const{t}=c();return T.useMemo(()=>[u.display({id:"sku",header:()=>e.jsx(m,{text:t("fields.sku")}),cell:()=>e.jsx(h,{text:i})}),u.accessor("line_item.order_id",{header:()=>e.jsx(m,{text:t("inventory.reservation.orderID")}),cell:({getValue:s})=>{const r=s();return r?e.jsx(h,{text:r}):e.jsx(l,{})}}),u.accessor("description",{header:()=>e.jsx(m,{text:t("fields.description")}),cell:({getValue:s})=>{const r=s();return r?e.jsx(h,{text:r}):e.jsx(l,{})}}),u.accessor("location.name",{header:()=>e.jsx(m,{text:t("inventory.reservation.location")}),cell:({getValue:s})=>{const r=s();return r?e.jsx(h,{text:r}):e.jsx(l,{})}}),u.accessor("created_at",{header:()=>e.jsx(m,{text:t("fields.createdAt")}),cell:({getValue:s})=>e.jsx(ue,{date:s()})}),u.accessor("quantity",{header:()=>e.jsx(m,{text:t("fields.quantity"),align:"right"}),cell:({getValue:s})=>e.jsx(h,{text:s(),align:"right"})}),u.display({id:"actions",cell:({row:s})=>e.jsx(me,{reservation:s.original})})],[t])},ve=({pageSize:i=20,prefix:t})=>{const s=R(["id","location_id","inventory_item_id","quantity","line_item_id","description","created_by"],t),{quantity:r,...a}=s;return{searchParams:{limit:i,quantity:r?JSON.parse(r):void 0,...a},raw:s}},S=20,pe=({inventoryItem:i})=>{const{searchParams:t,raw:s}=ve({pageSize:S}),{reservations:r,count:a,isPending:n,isError:o,error:f}=U({...t,inventory_item_id:[i.id]}),{stock_locations:x}=X({id:(r||[]).map(v=>v.location_id)}),_=T.useMemo(()=>{const v=new Map((x||[]).map(p=>[p.id,p]));return(r||[]).map(p=>({...p,location:v.get(p.location_id)}))},[r,x]),y=xe({sku:i.sku}),{table:Q}=z({data:_??[],columns:y,count:a,enablePagination:!0,getRowId:v=>v.id,pageSize:S});if(o)throw f;return e.jsx(E,{table:Q,columns:y,pageSize:S,count:a,isLoading:n,pagination:!0,queryObject:s})},he=({inventoryItem:i})=>{const{t}=c();return e.jsxs(b,{className:"divide-y p-0",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[e.jsx(g,{children:t("reservations.domain")}),e.jsx(D,{size:"small",variant:"secondary",asChild:!0,children:e.jsx(q,{to:`/reservations/create?item_id=${i.id}`,children:t("actions.create")})})]}),e.jsx(pe,{inventoryItem:i})]})},je=({variants:i})=>{const{t}=c();return i!=null&&i.length?e.jsxs(b,{className:"p-0",children:[e.jsx("div",{className:"flex items-center justify-between px-6 py-4",children:e.jsx(g,{level:"h2",children:t("inventory.associatedVariants")})}),e.jsx("div",{className:"txt-small flex flex-col gap-2 px-2 pb-2",children:i.map(s=>{var n;const r=s.product?`/products/${s.product.id}/variants/${s.id}`:null,a=e.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-component rounded-md px-4 py-2 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"shadow-elevation-card-rest rounded-md",children:e.jsx(G,{src:(n=s.product)==null?void 0:n.thumbnail})}),e.jsxs("div",{className:"flex flex-1 flex-col",children:[e.jsx("span",{className:"text-ui-fg-base font-medium",children:s.title}),e.jsx("span",{className:"text-ui-fg-subtle",children:s.options.map(o=>o.value).join(" â‹… ")})]}),e.jsx("div",{className:"size-7 flex items-center justify-center",children:e.jsx(W,{className:"text-ui-fg-muted"})})]})});return r?e.jsx(q,{to:r,className:"outline-none focus-within:shadow-borders-interactive-with-focus rounded-md [&:hover>div]:bg-ui-bg-component-hover",children:a},s.id):e.jsx("div",{children:a},s.id)})})]}):null},st=()=>{const{id:i}=H(),t=J(),{inventory_item:s,isPending:r,isError:a,error:n}=C(i,{fields:L},{initialData:t}),{getWidgets:o}=$();if(r||!s)return e.jsx(F,{showJSON:!0,mainSections:3,sidebarSections:2,showMetadata:!0});if(a)throw n;return e.jsxs(N,{widgets:{after:o("inventory_item.details.after"),before:o("inventory_item.details.before"),sideAfter:o("inventory_item.details.side.after"),sideBefore:o("inventory_item.details.side.before")},data:s,showJSON:!0,showMetadata:!0,children:[e.jsxs(N.Main,{children:[e.jsx(B,{inventoryItem:s}),e.jsx(de,{inventoryItem:s}),e.jsx(he,{inventoryItem:s})]}),e.jsxs(N.Sidebar,{children:[e.jsx(je,{variants:s.variants}),e.jsx(ae,{inventoryItem:s})]})]})},fe=i=>({queryKey:Y.detail(i),queryFn:async()=>K.admin.inventoryItem.retrieve(i,{fields:L})}),it=async({params:i})=>{const t=i.id,s=fe(t);return V.ensureQueryData(s)};export{tt as Breadcrumb,st as Component,it as loader};
