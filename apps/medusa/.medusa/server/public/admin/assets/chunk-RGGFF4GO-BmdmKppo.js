import{u as se,l as We}from"./lodash-Cir5W1CW.js";import{c as It,u as Xe}from"./chunk-BNLHRJ2A-B6UFSb8F.js";import{u as Et,R as z,T as Qe,P as q,C as H,A as Nt}from"./chunk-KHOKHZC6-CP-tyRv6.js";import{bj as G,bk as Pt,bl as ye,bm as ne,bn as Ft,bo as Dt,r as v,bp as _e,j as r,bq as je,br as Ze,bs as Mt,bt as J,bu as F,bv as Lt,bw as kt,b as Y,a6 as et,B as Gt,m as N,ai as ee,bx as ce,T as U,z as Q,x as Z,by as B,bz as Vt}from"./index-Br7KcgVZ.js";import{u as Kt}from"./chunk-EPATMX2O-Fnr0vyLv.js";import{_ as we,a as tt,b as at,e as Bt,i as Se,c as Ut,d as zt,f as oe,g as qt}from"./_isIndex-69RBt1x5.js";import{X as rt}from"./x-mark-mini-7wDt4qdT.js";import{D as Ce}from"./date-picker-DwI7Qf6K.js";var Ht=we;function Jt(){this.__data__=new Ht,this.size=0}var Yt=Jt;function Wt(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a}var Xt=Wt;function Qt(e){return this.__data__.get(e)}var Zt=Qt;function ea(e){return this.__data__.has(e)}var ta=ea,aa=we,ra=tt,sa=at,na=200;function oa(e,t){var a=this.__data__;if(a instanceof aa){var s=a.__data__;if(!ra||s.length<na-1)return s.push([e,t]),this.size=++a.size,this;a=this.__data__=new sa(s)}return a.set(e,t),this.size=a.size,this}var ia=oa,la=we,ca=Yt,ua=Xt,da=Zt,fa=ta,pa=ia;function V(e){var t=this.__data__=new la(e);this.size=t.size}V.prototype.clear=ca;V.prototype.delete=ua;V.prototype.get=da;V.prototype.has=fa;V.prototype.set=pa;var va=V,ga="__lodash_hash_undefined__";function ma(e){return this.__data__.set(e,ga),this}var ba=ma;function ha(e){return this.__data__.has(e)}var xa=ha,ya=at,_a=ba,ja=xa;function te(e){var t=-1,a=e==null?0:e.length;for(this.__data__=new ya;++t<a;)this.add(e[t])}te.prototype.add=te.prototype.push=_a;te.prototype.has=ja;var wa=te;function Sa(e,t){for(var a=-1,s=e==null?0:e.length;++a<s;)if(t(e[a],a,e))return!0;return!1}var Ta=Sa;function Aa(e,t){return e.has(t)}var Ca=Aa,Oa=wa,$a=Ta,Ra=Ca,Ia=1,Ea=2;function Na(e,t,a,s,o,n){var l=a&Ia,u=e.length,d=t.length;if(u!=d&&!(l&&d>u))return!1;var c=n.get(e),f=n.get(t);if(c&&f)return c==t&&f==e;var g=-1,m=!0,h=a&Ea?new Oa:void 0;for(n.set(e,t),n.set(t,e);++g<u;){var i=e[g],p=t[g];if(s)var _=l?s(p,i,g,t,e,n):s(i,p,g,e,t,n);if(_!==void 0){if(_)continue;m=!1;break}if(h){if(!$a(t,function(b,y){if(!Ra(h,y)&&(i===b||o(i,b,a,s,n)))return h.push(y)})){m=!1;break}}else if(!(i===p||o(i,p,a,s,n))){m=!1;break}}return n.delete(e),n.delete(t),m}var st=Na,Pa=G,Fa=Pa.Uint8Array,Da=Fa;function Ma(e){var t=-1,a=Array(e.size);return e.forEach(function(s,o){a[++t]=[o,s]}),a}var La=Ma;function ka(e){var t=-1,a=Array(e.size);return e.forEach(function(s){a[++t]=s}),a}var Ga=ka,Oe=Pt,$e=Da,Va=Bt,Ka=st,Ba=La,Ua=Ga,za=1,qa=2,Ha="[object Boolean]",Ja="[object Date]",Ya="[object Error]",Wa="[object Map]",Xa="[object Number]",Qa="[object RegExp]",Za="[object Set]",er="[object String]",tr="[object Symbol]",ar="[object ArrayBuffer]",rr="[object DataView]",Re=Oe?Oe.prototype:void 0,ue=Re?Re.valueOf:void 0;function sr(e,t,a,s,o,n,l){switch(a){case rr:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ar:return!(e.byteLength!=t.byteLength||!n(new $e(e),new $e(t)));case Ha:case Ja:case Xa:return Va(+e,+t);case Ya:return e.name==t.name&&e.message==t.message;case Qa:case er:return e==t+"";case Wa:var u=Ba;case Za:var d=s&za;if(u||(u=Ua),e.size!=t.size&&!d)return!1;var c=l.get(e);if(c)return c==t;s|=qa,l.set(e,t);var f=Ka(u(e),u(t),s,o,n,l);return l.delete(e),f;case tr:if(ue)return ue.call(e)==ue.call(t)}return!1}var nr=sr;function or(e,t){for(var a=-1,s=t.length,o=e.length;++a<s;)e[o+a]=t[a];return e}var ir=or,lr=ir,cr=Se;function ur(e,t,a){var s=t(e);return cr(e)?s:lr(s,a(e))}var dr=ur;function fr(e,t){for(var a=-1,s=e==null?0:e.length,o=0,n=[];++a<s;){var l=e[a];t(l,a,e)&&(n[o++]=l)}return n}var pr=fr;function vr(){return[]}var gr=vr,mr=pr,br=gr,hr=Object.prototype,xr=hr.propertyIsEnumerable,Ie=Object.getOwnPropertySymbols,yr=Ie?function(e){return e==null?[]:(e=Object(e),mr(Ie(e),function(t){return xr.call(e,t)}))}:br,_r=yr;function jr(e,t){for(var a=-1,s=Array(e);++a<e;)s[a]=t(a);return s}var wr=jr,Sr=ye,Tr=ne,Ar="[object Arguments]";function Cr(e){return Tr(e)&&Sr(e)==Ar}var Or=Cr,Ee=Or,$r=ne,nt=Object.prototype,Rr=nt.hasOwnProperty,Ir=nt.propertyIsEnumerable,Er=Ee(function(){return arguments}())?Ee:function(e){return $r(e)&&Rr.call(e,"callee")&&!Ir.call(e,"callee")},Nr=Er,ae={exports:{}};function Pr(){return!1}var Fr=Pr;ae.exports;(function(e,t){var a=G,s=Fr,o=t&&!t.nodeType&&t,n=o&&!0&&e&&!e.nodeType&&e,l=n&&n.exports===o,u=l?a.Buffer:void 0,d=u?u.isBuffer:void 0,c=d||s;e.exports=c})(ae,ae.exports);var ot=ae.exports,Dr=9007199254740991;function Mr(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Dr}var it=Mr,Lr=ye,kr=it,Gr=ne,Vr="[object Arguments]",Kr="[object Array]",Br="[object Boolean]",Ur="[object Date]",zr="[object Error]",qr="[object Function]",Hr="[object Map]",Jr="[object Number]",Yr="[object Object]",Wr="[object RegExp]",Xr="[object Set]",Qr="[object String]",Zr="[object WeakMap]",es="[object ArrayBuffer]",ts="[object DataView]",as="[object Float32Array]",rs="[object Float64Array]",ss="[object Int8Array]",ns="[object Int16Array]",os="[object Int32Array]",is="[object Uint8Array]",ls="[object Uint8ClampedArray]",cs="[object Uint16Array]",us="[object Uint32Array]",S={};S[as]=S[rs]=S[ss]=S[ns]=S[os]=S[is]=S[ls]=S[cs]=S[us]=!0;S[Vr]=S[Kr]=S[es]=S[Br]=S[ts]=S[Ur]=S[zr]=S[qr]=S[Hr]=S[Jr]=S[Yr]=S[Wr]=S[Xr]=S[Qr]=S[Zr]=!1;function ds(e){return Gr(e)&&kr(e.length)&&!!S[Lr(e)]}var fs=ds;function ps(e){return function(t){return e(t)}}var vs=ps,re={exports:{}};re.exports;(function(e,t){var a=Ft,s=t&&!t.nodeType&&t,o=s&&!0&&e&&!e.nodeType&&e,n=o&&o.exports===s,l=n&&a.process,u=function(){try{var d=o&&o.require&&o.require("util").types;return d||l&&l.binding&&l.binding("util")}catch{}}();e.exports=u})(re,re.exports);var gs=re.exports,ms=fs,bs=vs,Ne=gs,Pe=Ne&&Ne.isTypedArray,hs=Pe?bs(Pe):ms,lt=hs,xs=wr,ys=Nr,_s=Se,js=ot,ws=Ut,Ss=lt,Ts=Object.prototype,As=Ts.hasOwnProperty;function Cs(e,t){var a=_s(e),s=!a&&ys(e),o=!a&&!s&&js(e),n=!a&&!s&&!o&&Ss(e),l=a||s||o||n,u=l?xs(e.length,String):[],d=u.length;for(var c in e)(t||As.call(e,c))&&!(l&&(c=="length"||o&&(c=="offset"||c=="parent")||n&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||ws(c,d)))&&u.push(c);return u}var Os=Cs,$s=Object.prototype;function Rs(e){var t=e&&e.constructor,a=typeof t=="function"&&t.prototype||$s;return e===a}var Is=Rs;function Es(e,t){return function(a){return e(t(a))}}var Ns=Es,Ps=Ns,Fs=Ps(Object.keys,Object),Ds=Fs,Ms=Is,Ls=Ds,ks=Object.prototype,Gs=ks.hasOwnProperty;function Vs(e){if(!Ms(e))return Ls(e);var t=[];for(var a in Object(e))Gs.call(e,a)&&a!="constructor"&&t.push(a);return t}var Ks=Vs,Bs=zt,Us=it;function zs(e){return e!=null&&Us(e.length)&&!Bs(e)}var qs=zs,Hs=Os,Js=Ks,Ys=qs;function Ws(e){return Ys(e)?Hs(e):Js(e)}var Xs=Ws,Qs=dr,Zs=_r,en=Xs;function tn(e){return Qs(e,en,Zs)}var an=tn,Fe=an,rn=1,sn=Object.prototype,nn=sn.hasOwnProperty;function on(e,t,a,s,o,n){var l=a&rn,u=Fe(e),d=u.length,c=Fe(t),f=c.length;if(d!=f&&!l)return!1;for(var g=d;g--;){var m=u[g];if(!(l?m in t:nn.call(t,m)))return!1}var h=n.get(e),i=n.get(t);if(h&&i)return h==t&&i==e;var p=!0;n.set(e,t),n.set(t,e);for(var _=l;++g<d;){m=u[g];var b=e[m],y=t[m];if(s)var A=l?s(y,b,m,t,e,n):s(b,y,m,e,t,n);if(!(A===void 0?b===y||o(b,y,a,s,n):A)){p=!1;break}_||(_=m=="constructor")}if(p&&!_){var C=e.constructor,$=t.constructor;C!=$&&"constructor"in e&&"constructor"in t&&!(typeof C=="function"&&C instanceof C&&typeof $=="function"&&$ instanceof $)&&(p=!1)}return n.delete(e),n.delete(t),p}var ln=on,cn=oe,un=G,dn=cn(un,"DataView"),fn=dn,pn=oe,vn=G,gn=pn(vn,"Promise"),mn=gn,bn=oe,hn=G,xn=bn(hn,"Set"),yn=xn,_n=oe,jn=G,wn=_n(jn,"WeakMap"),Sn=wn,ve=fn,ge=tt,me=mn,be=yn,he=Sn,ct=ye,K=qt,De="[object Map]",Tn="[object Object]",Me="[object Promise]",Le="[object Set]",ke="[object WeakMap]",Ge="[object DataView]",An=K(ve),Cn=K(ge),On=K(me),$n=K(be),Rn=K(he),L=ct;(ve&&L(new ve(new ArrayBuffer(1)))!=Ge||ge&&L(new ge)!=De||me&&L(me.resolve())!=Me||be&&L(new be)!=Le||he&&L(new he)!=ke)&&(L=function(e){var t=ct(e),a=t==Tn?e.constructor:void 0,s=a?K(a):"";if(s)switch(s){case An:return Ge;case Cn:return De;case On:return Me;case $n:return Le;case Rn:return ke}return t});var In=L,de=va,En=st,Nn=nr,Pn=ln,Ve=In,Ke=Se,Be=ot,Fn=lt,Dn=1,Ue="[object Arguments]",ze="[object Array]",X="[object Object]",Mn=Object.prototype,qe=Mn.hasOwnProperty;function Ln(e,t,a,s,o,n){var l=Ke(e),u=Ke(t),d=l?ze:Ve(e),c=u?ze:Ve(t);d=d==Ue?X:d,c=c==Ue?X:c;var f=d==X,g=c==X,m=d==c;if(m&&Be(e)){if(!Be(t))return!1;l=!0,f=!1}if(m&&!f)return n||(n=new de),l||Fn(e)?En(e,t,a,s,o,n):Nn(e,t,d,a,s,o,n);if(!(a&Dn)){var h=f&&qe.call(e,"__wrapped__"),i=g&&qe.call(t,"__wrapped__");if(h||i){var p=h?e.value():e,_=i?t.value():t;return n||(n=new de),o(p,_,a,s,n)}}return m?(n||(n=new de),Pn(e,t,a,s,o,n)):!1}var kn=Ln,Gn=kn,He=ne;function ut(e,t,a,s,o){return e===t?!0:e==null||t==null||!He(e)&&!He(t)?e!==e&&t!==t:Gn(e,t,a,s,ut,o)}var Vn=ut,Kn=Vn;function Bn(e,t){return Kn(e,t)}var Un=Bn;const zn=Dt(Un);var dt=v.createContext(null),W=()=>{const e=v.useContext(dt);if(!e)throw new Error("useDataTableFacetedFilterContext must be used within a DataTableFacetedFilter");return e},qn=({hadPreviousValue:e,label:t,value:a,readonly:s,hasOperator:o,onRemove:n})=>{const{t:l}=Y(),u=d=>{d.stopPropagation(),n()};return r.jsxs("div",{className:"bg-ui-bg-field transition-fg shadow-borders-base text-ui-fg-subtle flex cursor-default select-none items-stretch overflow-hidden rounded-md",children:[!e&&r.jsx(Nt,{}),r.jsx("div",{className:N("flex items-center justify-center whitespace-nowrap px-2 py-1",{"border-r":!!(a||e)}),children:r.jsx(U,{size:"small",weight:"plus",leading:"compact",children:t})}),r.jsxs("div",{className:"flex w-full items-center overflow-hidden",children:[o&&!!(a||e)&&r.jsx("div",{className:"border-r p-1 px-2",children:r.jsx(U,{size:"small",weight:"plus",leading:"compact",className:"text-ui-fg-muted",children:l("general.is")})}),!!(a||e)&&r.jsx(Qe,{asChild:!0,className:N("flex-1 cursor-pointer overflow-hidden border-r p-1 px-2",{"hover:bg-ui-bg-field-hover":!s,"data-[state=open]:bg-ui-bg-field-hover":!s}),children:r.jsx(U,{size:"small",leading:"compact",weight:"plus",className:"truncate text-nowrap",children:a||"Â "})})]}),!s&&!!(a||e)&&r.jsx("button",{onClick:u,className:N("text-ui-fg-muted transition-fg flex items-center justify-center p-1","hover:bg-ui-bg-subtle-hover","active:bg-ui-bg-subtle-pressed active:text-ui-fg-base"),children:r.jsx(rt,{})})]})},ie=qn,Hn=({filter:e,prefix:t,readonly:a,openOnMount:s})=>{const[o,n]=v.useState(s),[l,u]=v.useState(!1),{getFullDate:d}=Kt(),{key:c,label:f}=e,{removeFilter:g}=W(),m=se({param:c,prefix:t}),h=Jn(),i=x=>{m.add(JSON.stringify(x)),u(!1)},p=()=>{m.delete(),u(x=>!x)},_=m.get(),b=Yn(_),y=Je(b,"$gte"),A=Je(b,"$lte"),C=(x,I)=>{const E=I==="start"?"$gte":"$lte",Rt=x?x.toISOString():void 0;m.add(JSON.stringify({...b||{},[E]:Rt}))},$=()=>{const x=h.find(I=>zn(I.value,b));return x==null?void 0:x.label},D=x=>x?d({date:x}):void 0,P=()=>[y,A].map(D).filter(Boolean).join(" - "),T=$()||P(),[M,w]=v.useState(T),R=()=>{m.delete(),g(c)};let O=null;const j=x=>{n(x),w(T),O&&clearTimeout(O),!x&&!_.length&&(O=setTimeout(()=>{g(c)},200))};return r.jsxs(z,{modal:!0,open:o,onOpenChange:j,children:[r.jsx(ie,{hadPreviousValue:!!M,label:f,value:T,onRemove:R,readonly:a}),!a&&r.jsx(q,{children:r.jsxs(H,{"data-name":"date_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:N("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout h-full max-h-[var(--radix-popper-available-height)] w-[300px] overflow-auto rounded-lg"),onInteractOutside:x=>{var I;x.target instanceof HTMLElement&&((I=x.target.attributes.getNamedItem("data-name"))==null?void 0:I.value)==="filters_menu_content"&&x.preventDefault()},children:[r.jsxs("ul",{className:"w-full p-1",children:[h.map(x=>{const I=m.get().includes(JSON.stringify(x.value));return r.jsx("li",{children:r.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:()=>{i(x.value)},children:[r.jsx("div",{className:N("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!I}),children:r.jsx(ee,{})}),x.label]})},x.label)}),r.jsx("li",{children:r.jsxs("button",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex w-full cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",type:"button",onClick:p,children:[r.jsx("div",{className:N("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!l}),children:r.jsx(ee,{})}),ce("filters.date.custom")]})})]}),l&&r.jsxs("div",{className:"border-t px-1 pb-3 pt-1",children:[r.jsxs("div",{children:[r.jsx("div",{className:"px-2 py-1",children:r.jsx(U,{size:"xsmall",leading:"compact",weight:"plus",children:ce("filters.date.from")})}),r.jsx("div",{className:"px-2 py-1",children:r.jsx(Ce,{modal:!0,maxValue:A,value:y,onChange:x=>C(x,"start")})})]}),r.jsxs("div",{children:[r.jsx("div",{className:"px-2 py-1",children:r.jsx(U,{size:"xsmall",leading:"compact",weight:"plus",children:ce("filters.date.to")})}),r.jsx("div",{className:"px-2 py-1",children:r.jsx(Ce,{modal:!0,minValue:y,value:A||void 0,onChange:x=>{C(x,"end")}})})]})]})]})})]})},k=new Date;k.setHours(0,0,0,0);var Jn=()=>{const{t:e}=Y();return v.useMemo(()=>[{label:e("filters.date.today"),value:{$gte:k.toISOString()}},{label:e("filters.date.lastSevenDays"),value:{$gte:new Date(k.getTime()-7*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastThirtyDays"),value:{$gte:new Date(k.getTime()-30*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastNinetyDays"),value:{$gte:new Date(k.getTime()-90*24*60*60*1e3).toISOString()}},{label:e("filters.date.lastTwelveMonths"),value:{$gte:new Date(k.getTime()-365*24*60*60*1e3).toISOString()}}],[e])},Yn=e=>e!=null&&e.length?JSON.parse(e.join(",")):null,Je=(e,t)=>e!=null&&e[t]?new Date(e[t]):void 0,fe="rovingFocusGroup.onEntryFocus",Wn={bubbles:!1,cancelable:!0},le="RovingFocusGroup",[xe,ft,Xn]=It(le),[Qn,pt]=_e(le,[Xn]),[Zn,eo]=Qn(le),vt=v.forwardRef((e,t)=>r.jsx(xe.Provider,{scope:e.__scopeRovingFocusGroup,children:r.jsx(xe.Slot,{scope:e.__scopeRovingFocusGroup,children:r.jsx(to,{...e,ref:t})})}));vt.displayName=le;var to=v.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:a,orientation:s,loop:o=!1,dir:n,currentTabStopId:l,defaultCurrentTabStopId:u,onCurrentTabStopIdChange:d,onEntryFocus:c,preventScrollOnEntryFocus:f=!1,...g}=e,m=v.useRef(null),h=je(t,m),i=Xe(n),[p=null,_]=Ze({prop:l,defaultProp:u,onChange:d}),[b,y]=v.useState(!1),A=Mt(c),C=ft(a),$=v.useRef(!1),[D,P]=v.useState(0);return v.useEffect(()=>{const T=m.current;if(T)return T.addEventListener(fe,A),()=>T.removeEventListener(fe,A)},[A]),r.jsx(Zn,{scope:a,orientation:s,dir:i,loop:o,currentTabStopId:p,onItemFocus:v.useCallback(T=>_(T),[_]),onItemShiftTab:v.useCallback(()=>y(!0),[]),onFocusableItemAdd:v.useCallback(()=>P(T=>T+1),[]),onFocusableItemRemove:v.useCallback(()=>P(T=>T-1),[]),children:r.jsx(J.div,{tabIndex:b||D===0?-1:0,"data-orientation":s,...g,ref:h,style:{outline:"none",...e.style},onMouseDown:F(e.onMouseDown,()=>{$.current=!0}),onFocus:F(e.onFocus,T=>{const M=!$.current;if(T.target===T.currentTarget&&M&&!b){const w=new CustomEvent(fe,Wn);if(T.currentTarget.dispatchEvent(w),!w.defaultPrevented){const R=C().filter(E=>E.focusable),O=R.find(E=>E.active),j=R.find(E=>E.id===p),I=[O,j,...R].filter(Boolean).map(E=>E.ref.current);bt(I,f)}}$.current=!1}),onBlur:F(e.onBlur,()=>y(!1))})})}),gt="RovingFocusGroupItem",mt=v.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:a,focusable:s=!0,active:o=!1,tabStopId:n,...l}=e,u=Lt(),d=n||u,c=eo(gt,a),f=c.currentTabStopId===d,g=ft(a),{onFocusableItemAdd:m,onFocusableItemRemove:h}=c;return v.useEffect(()=>{if(s)return m(),()=>h()},[s,m,h]),r.jsx(xe.ItemSlot,{scope:a,id:d,focusable:s,active:o,children:r.jsx(J.span,{tabIndex:f?0:-1,"data-orientation":c.orientation,...l,ref:t,onMouseDown:F(e.onMouseDown,i=>{s?c.onItemFocus(d):i.preventDefault()}),onFocus:F(e.onFocus,()=>c.onItemFocus(d)),onKeyDown:F(e.onKeyDown,i=>{if(i.key==="Tab"&&i.shiftKey){c.onItemShiftTab();return}if(i.target!==i.currentTarget)return;const p=so(i,c.orientation,c.dir);if(p!==void 0){if(i.metaKey||i.ctrlKey||i.altKey||i.shiftKey)return;i.preventDefault();let b=g().filter(y=>y.focusable).map(y=>y.ref.current);if(p==="last")b.reverse();else if(p==="prev"||p==="next"){p==="prev"&&b.reverse();const y=b.indexOf(i.currentTarget);b=c.loop?no(b,y+1):b.slice(y+1)}setTimeout(()=>bt(b))}})})})});mt.displayName=gt;var ao={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ro(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function so(e,t,a){const s=ro(e.key,a);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(s))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(s)))return ao[s]}function bt(e,t=!1){const a=document.activeElement;for(const s of e)if(s===a||(s.focus({preventScroll:t}),document.activeElement!==a))return}function no(e,t){return e.map((a,s)=>e[(t+s)%e.length])}var oo=vt,io=mt;function lo(e){const t=v.useRef({value:e,previous:e});return v.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Te="Radio",[co,ht]=_e(Te),[uo,fo]=co(Te),xt=v.forwardRef((e,t)=>{const{__scopeRadio:a,name:s,checked:o=!1,required:n,disabled:l,value:u="on",onCheck:d,...c}=e,[f,g]=v.useState(null),m=je(t,p=>g(p)),h=v.useRef(!1),i=f?!!f.closest("form"):!0;return r.jsxs(uo,{scope:a,checked:o,disabled:l,children:[r.jsx(J.button,{type:"button",role:"radio","aria-checked":o,"data-state":jt(o),"data-disabled":l?"":void 0,disabled:l,value:u,...c,ref:m,onClick:F(e.onClick,p=>{o||d==null||d(),i&&(h.current=p.isPropagationStopped(),h.current||p.stopPropagation())})}),i&&r.jsx(po,{control:f,bubbles:!h.current,name:s,value:u,checked:o,required:n,disabled:l,style:{transform:"translateX(-100%)"}})]})});xt.displayName=Te;var yt="RadioIndicator",_t=v.forwardRef((e,t)=>{const{__scopeRadio:a,forceMount:s,...o}=e,n=fo(yt,a);return r.jsx(kt,{present:s||n.checked,children:r.jsx(J.span,{"data-state":jt(n.checked),"data-disabled":n.disabled?"":void 0,...o,ref:t})})});_t.displayName=yt;var po=e=>{const{control:t,checked:a,bubbles:s=!0,...o}=e,n=v.useRef(null),l=lo(a),u=Et(t);return v.useEffect(()=>{const d=n.current,c=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(c,"checked").set;if(l!==a&&g){const m=new Event("click",{bubbles:s});g.call(d,a),d.dispatchEvent(m)}},[l,a,s]),r.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:a,...o,tabIndex:-1,ref:n,style:{...e.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function jt(e){return e?"checked":"unchecked"}var vo=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ae="RadioGroup",[go,Do]=_e(Ae,[pt,ht]),wt=pt(),St=ht(),[mo,bo]=go(Ae),Tt=v.forwardRef((e,t)=>{const{__scopeRadioGroup:a,name:s,defaultValue:o,value:n,required:l=!1,disabled:u=!1,orientation:d,dir:c,loop:f=!0,onValueChange:g,...m}=e,h=wt(a),i=Xe(c),[p,_]=Ze({prop:n,defaultProp:o,onChange:g});return r.jsx(mo,{scope:a,name:s,required:l,disabled:u,value:p,onValueChange:_,children:r.jsx(oo,{asChild:!0,...h,orientation:d,dir:i,loop:f,children:r.jsx(J.div,{role:"radiogroup","aria-required":l,"aria-orientation":d,"data-disabled":u?"":void 0,dir:i,...m,ref:t})})})});Tt.displayName=Ae;var At="RadioGroupItem",Ct=v.forwardRef((e,t)=>{const{__scopeRadioGroup:a,disabled:s,...o}=e,n=bo(At,a),l=n.disabled||s,u=wt(a),d=St(a),c=v.useRef(null),f=je(t,c),g=n.value===o.value,m=v.useRef(!1);return v.useEffect(()=>{const h=p=>{vo.includes(p.key)&&(m.current=!0)},i=()=>m.current=!1;return document.addEventListener("keydown",h),document.addEventListener("keyup",i),()=>{document.removeEventListener("keydown",h),document.removeEventListener("keyup",i)}},[]),r.jsx(io,{asChild:!0,...u,focusable:!l,active:g,children:r.jsx(xt,{disabled:l,required:n.required,checked:g,...d,...o,name:n.name,ref:f,onCheck:()=>n.onValueChange(o.value),onKeyDown:F(h=>{h.key==="Enter"&&h.preventDefault()}),onFocus:F(o.onFocus,()=>{var h;m.current&&((h=c.current)==null||h.click())})})})});Ct.displayName=At;var ho="RadioGroupIndicator",Ot=v.forwardRef((e,t)=>{const{__scopeRadioGroup:a,...s}=e,o=St(a);return r.jsx(_t,{...o,...s,ref:t})});Ot.displayName=ho;var xo=Tt,yo=Ct,_o=Ot,jo=({filter:e,prefix:t,readonly:a,openOnMount:s})=>{const{t:o}=Y(),[n,l]=v.useState(s),{key:u,label:d}=e,{removeFilter:c}=W(),f=se({param:u,prefix:t,multiple:!1}),g=f.get(),[m,h]=v.useState(g),[i,p]=v.useState(wo(g)),_=v.useCallback(We.debounce((w,R)=>{const O=w.target.value,j=JSON.parse((g==null?void 0:g.join(","))||"{}"),x=!isNaN(Number(j)),I=E=>{if(!O&&x){f.delete();return}if(j&&!O){delete j[E],f.add(JSON.stringify(j));return}if(!j){f.add(JSON.stringify({[E]:O}));return}f.add(JSON.stringify({...j,[E]:O}))};switch(R){case"eq":O?f.add(O):f.delete();break;case"lt":case"gt":I(R);break}},500),[f,g]);v.useEffect(()=>()=>{_.cancel()},[_]);let b=null;const y=w=>{l(w),h(g),b&&clearTimeout(b),!w&&!g.length&&(b=setTimeout(()=>{c(u)},200))},A=()=>{f.delete(),c(u)},C=[{operator:"exact",label:o("filters.compare.exact")},{operator:"range",label:o("filters.compare.range")}],$=`${u}-gt`,D=`${u}-lt`,P=u,T=Ye(g,o),M=Ye(m,o);return r.jsxs(z,{modal:!0,open:n,onOpenChange:y,children:[r.jsx(ie,{hasOperator:!0,hadPreviousValue:!!M,label:d,value:T,onRemove:A,readonly:a}),!a&&r.jsx(q,{children:r.jsxs(H,{"data-name":"number_filter_content",align:"start",sideOffset:8,collisionPadding:24,className:N("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout max-h-[var(--radix-popper-available-height)] w-[300px] divide-y overflow-y-auto rounded-lg outline-none"),onInteractOutside:w=>{var R;w.target instanceof HTMLElement&&((R=w.target.attributes.getNamedItem("data-name"))==null?void 0:R.value)==="filters_menu_content"&&w.preventDefault()},children:[r.jsx("div",{className:"p-1",children:r.jsx(xo,{value:i,onValueChange:w=>p(w),className:"flex flex-col items-start",orientation:"vertical",autoFocus:!0,children:C.map(w=>r.jsxs(yo,{value:w.operator,className:"txt-compact-small hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-hover active:bg-ui-bg-base-pressed transition-fg grid w-full grid-cols-[20px_1fr] gap-2 rounded-[4px] px-2 py-1.5 text-left outline-none",children:[r.jsx("div",{className:"size-5",children:r.jsx(_o,{children:r.jsx(ee,{})})}),r.jsx("span",{className:"w-full",children:w.label})]},w.operator))})}),r.jsx("div",{children:i==="range"?r.jsxs("div",{className:"px-1 pb-3 pt-1",children:[r.jsx("div",{className:"px-2 py-1.5",children:r.jsx(Q,{size:"xsmall",weight:"plus",htmlFor:$,children:o("filters.compare.greaterThan")})}),r.jsx("div",{className:"px-2 py-0.5",children:r.jsx(Z,{name:$,size:"small",type:"number",defaultValue:pe(g,"gt"),onChange:w=>_(w,"gt")})}),r.jsx("div",{className:"px-2 py-1.5",children:r.jsx(Q,{size:"xsmall",weight:"plus",htmlFor:D,children:o("filters.compare.lessThan")})}),r.jsx("div",{className:"px-2 py-0.5",children:r.jsx(Z,{name:D,size:"small",type:"number",defaultValue:pe(g,"lt"),onChange:w=>_(w,"lt")})})]},"range"):r.jsxs("div",{className:"px-1 pb-3 pt-1",children:[r.jsx("div",{className:"px-2 py-1.5",children:r.jsx(Q,{size:"xsmall",weight:"plus",htmlFor:P,children:d})}),r.jsx("div",{className:"px-2 py-0.5",children:r.jsx(Z,{name:P,size:"small",type:"number",defaultValue:pe(g,"eq"),onChange:w=>_(w,"eq")})})]},"exact")})]})})]})},Ye=(e,t)=>{const a=JSON.parse((e==null?void 0:e.join(","))||"{}");let s="";if(typeof a=="object"){const o=[];a.gt&&o.push(t("filters.compare.greaterThanLabel",{value:a.gt})),a.lt&&o.push(t("filters.compare.lessThanLabel",{value:a.lt})),s=o.join(` ${t("filters.compare.andLabel")} `)}return typeof a=="number"&&(s=a.toString()),s},$t=e=>{if(!e)return;const t=e.join(",");if(t)return JSON.parse(t)},pe=(e,t)=>{const a=$t(e);if(typeof a=="object")return a[t];if(typeof a=="number"&&t==="eq")return a},wo=e=>typeof $t(e)=="object"?"range":"exact",So=({filter:e,prefix:t,readonly:a,multiple:s,searchable:o,options:n,openOnMount:l})=>{const[u,d]=v.useState(l),[c,f]=v.useState(""),[g,m]=v.useState(null),{t:h}=Y(),{removeFilter:i}=W(),{key:p,label:_}=e,b=se({param:p,prefix:t,multiple:s}),y=b.get(),A=y.map(j=>{var x;return(x=n.find(I=>I.value===j))==null?void 0:x.label}).filter(Boolean),[C,$]=v.useState(A),D=()=>{b.delete(),i(p)};let P=null;const T=j=>{d(j),$(A),P&&clearTimeout(P),!j&&!y.length&&(P=setTimeout(()=>{i(p)},200))},M=()=>{f(""),g&&g.focus()},w=j=>{b.get().includes(String(j))?b.delete(String(j)):b.add(String(j))},R=A?Array.isArray(A)?A:[A]:null,O=C?Array.isArray(C)?C:[C]:null;return r.jsxs(z,{modal:!0,open:u,onOpenChange:T,children:[r.jsx(ie,{hasOperator:!0,hadPreviousValue:!!(O!=null&&O.length),readonly:a,label:_,value:R==null?void 0:R.join(", "),onRemove:D}),!a&&r.jsx(q,{children:r.jsx(H,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:N("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:j=>{var x;j.target instanceof HTMLElement&&((x=j.target.attributes.getNamedItem("data-name"))==null?void 0:x.value)==="filters_menu_content"&&(j.preventDefault(),j.stopPropagation())},children:r.jsxs(B,{className:"h-full",children:[o&&r.jsx("div",{className:"border-b p-1",children:r.jsxs("div",{className:"grid grid-cols-[1fr_20px] gap-x-2 rounded-md px-2 py-1",children:[r.jsx(B.Input,{ref:m,value:c,onValueChange:f,className:"txt-compact-small placeholder:text-ui-fg-muted bg-transparent outline-none",placeholder:"Search"}),r.jsx("div",{className:"flex h-5 w-5 items-center justify-center",children:r.jsx("button",{disabled:!c,onClick:M,className:N("transition-fg text-ui-fg-muted focus-visible:bg-ui-bg-base-pressed rounded-md outline-none",{invisible:!c}),children:r.jsx(rt,{})})})]})}),r.jsx(B.Empty,{className:"txt-compact-small flex items-center justify-center p-1",children:r.jsx("span",{className:"w-full px-2 py-1 text-center",children:h("general.noResultsTitle")})}),r.jsx(B.List,{className:"h-full max-h-[163px] min-h-[0] overflow-auto p-1 outline-none",children:n.map(j=>{const x=b.get().includes(String(j.value));return r.jsxs(B.Item,{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover aria-selected:bg-ui-bg-base-pressed focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center gap-x-2 rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",value:j.label,onSelect:()=>{w(j.value)},children:[r.jsx("div",{className:N("transition-fg flex h-5 w-5 items-center justify-center",{"[&_svg]:invisible":!x}),children:s?r.jsx(Vt,{}):r.jsx(ee,{})}),j.label]},String(j.value))})})]})})})]})},To=({filter:e,prefix:t,readonly:a,openOnMount:s})=>{const[o,n]=v.useState(s),{key:l,label:u}=e,{removeFilter:d}=W(),c=se({param:l,prefix:t}),f=c.get(),[g,m]=v.useState(f==null?void 0:f[0]),h=v.useCallback(We.debounce(b=>{const y=b.target.value;y?c.add(y):c.delete()},500),[c]);v.useEffect(()=>()=>{h.cancel()},[h]);let i=null;const p=b=>{n(b),m(f==null?void 0:f[0]),i&&clearTimeout(i),!b&&!f.length&&(i=setTimeout(()=>{d(l)},200))},_=()=>{c.delete(),d(l)};return r.jsxs(z,{modal:!0,open:o,onOpenChange:p,children:[r.jsx(ie,{hasOperator:!0,hadPreviousValue:!!g,label:u,value:f==null?void 0:f[0],onRemove:_,readonly:a}),!a&&r.jsx(q,{children:r.jsx(H,{hideWhenDetached:!0,align:"start",sideOffset:8,collisionPadding:8,className:N("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-hidden rounded-lg outline-none"),onInteractOutside:b=>{var y;b.target instanceof HTMLElement&&((y=b.target.attributes.getNamedItem("data-name"))==null?void 0:y.value)==="filters_menu_content"&&(b.preventDefault(),b.stopPropagation())},children:r.jsxs("div",{className:"px-1 pb-3 pt-1",children:[r.jsx("div",{className:"px-2 py-1.5",children:r.jsx(Q,{size:"xsmall",weight:"plus",htmlFor:l,children:u})}),r.jsx("div",{className:"px-2 py-0.5",children:r.jsx(Z,{name:l,size:"small",defaultValue:(f==null?void 0:f[0])||void 0,onChange:h})})]})})})]})},Mo=({filters:e,readonly:t,prefix:a})=>{const{t:s}=Y(),[o]=et(),[n,l]=v.useState(!1),[u,d]=v.useState(Co({searchParams:o,filters:e,prefix:a})),c=e.filter(i=>!u.find(p=>p.key===i.key)),f=v.useRef(!0);v.useEffect(()=>{if(f.current){const i=new URLSearchParams(o);e.forEach(p=>{const _=a?`${a}_${p.key}`:p.key;i.get(_)&&!u.find(y=>y.key===p.key)&&(p.type==="select"?d(y=>[...y,{...p,multiple:p.multiple,options:p.options,openOnMount:!1}]):d(y=>[...y,{...p,openOnMount:!1}]))})}f.current=!1},[u,e,a,o]);const g=i=>{l(!1),d(p=>[...p,{...i,openOnMount:!0}])},m=v.useCallback(i=>{d(p=>p.filter(_=>_.key!==i))},[]),h=v.useCallback(()=>{d([])},[]);return r.jsx(dt.Provider,{value:v.useMemo(()=>({removeFilter:m,removeAllFilters:h}),[h,m]),children:r.jsxs("div",{className:"max-w-2/3 flex flex-wrap items-center gap-2",children:[u.map(i=>{switch(i.type){case"select":return r.jsx(So,{filter:i,prefix:a,readonly:t,options:i.options,multiple:i.multiple,searchable:i.searchable,openOnMount:i.openOnMount},i.key);case"date":return r.jsx(Hn,{filter:i,prefix:a,readonly:t,openOnMount:i.openOnMount},i.key);case"string":return r.jsx(To,{filter:i,prefix:a,readonly:t,openOnMount:i.openOnMount},i.key);case"number":return r.jsx(jo,{filter:i,prefix:a,readonly:t,openOnMount:i.openOnMount},i.key)}}),!t&&c.length>0&&r.jsxs(z,{modal:!0,open:n,onOpenChange:l,children:[r.jsx(Qe,{asChild:!0,id:"filters_menu_trigger",children:r.jsx(Gt,{size:"small",variant:"secondary",children:s("filters.addFilter")})}),r.jsx(q,{children:r.jsx(H,{className:N("bg-ui-bg-base text-ui-fg-base shadow-elevation-flyout z-[1] h-full max-h-[200px] w-[300px] overflow-auto rounded-lg p-1 outline-none"),"data-name":"filters_menu_content",align:"start",sideOffset:8,collisionPadding:8,onCloseAutoFocus:i=>{u.find(_=>_.openOnMount)&&i.preventDefault()},children:c.map(i=>r.jsx("div",{className:"bg-ui-bg-base hover:bg-ui-bg-base-hover focus-visible:bg-ui-bg-base-pressed text-ui-fg-base data-[disabled]:text-ui-fg-disabled txt-compact-small relative flex cursor-pointer select-none items-center rounded-md px-2 py-1.5 outline-none transition-colors data-[disabled]:pointer-events-none",role:"menuitem",onClick:()=>{g(i)},children:i.label},i.key))})})]}),!t&&u.length>0&&r.jsx(Ao,{filters:e,prefix:a})]})})},Ao=({filters:e,prefix:t})=>{const{removeAllFilters:a}=W(),[s,o]=et(),n=()=>{o(l=>{const u=new URLSearchParams(l);return e.forEach(d=>{u.delete(t?`${t}_${d.key}`:d.key)}),u}),a()};return r.jsx("button",{type:"button",onClick:n,className:N("text-ui-fg-muted transition-fg txt-compact-small-plus rounded-md px-2 py-1","hover:text-ui-fg-subtle","focus-visible:shadow-borders-focus"),children:"Clear all"})},Co=({searchParams:e,filters:t,prefix:a})=>{const s=new URLSearchParams(e),o=[];return t.forEach(n=>{const l=a?`${a}_${n.key}`:n.key;s.get(l)&&(n.type==="select"?o.push({...n,multiple:n.multiple,options:n.options,openOnMount:!1}):o.push({...n,openOnMount:!1}))}),o};export{Mo as D};
